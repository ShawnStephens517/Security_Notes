#Methodology
## SMTP

||   |  |
|---|---|
|**Command**| **Description**|
|`AUTH PLAIN`|AUTH is a service extension used to authenticate the client.|
|`HELO`|The client logs in with its computer name and thus starts the session.|
|`MAIL FROM`|The client names the email sender.|
|`RCPT TO`|The client names the email recipient.|
|`DATA`|The client initiates the transmission of the email.|
|`RSET`|The client aborts the initiated transmission but keeps the connection between client and server.|
|`VRFY`|The client checks if a mailbox is available for message transfer.|
|`EXPN`|The client also checks if a mailbox is available for messaging with this command.|
|`NOOP`|The client requests a response from the server to prevent disconnection due to time-out.|
|`QUIT`|The client terminates the session.|     |     |

***Interact with SMTP Server***
#Helpful [SMTP Response Codes](https://serversmtp.com/smtp-error/)
```bash
telnet <IPaddress> 25

HELO mail.<domain.tld>
EHLO mail

VRFY root
VRFY testuser
```

```bash
MAIL FROM: <emailaddress@domain>
RCPT TO: <emailreceipient@domain> NOTIFY=success,failure

DATA
```

#Helpful #Tool 
```bash
smtp-user-enum -M VRFY -U <user_list> -t <email server>
smtp-user-enum -M EXPN -U <user_list> -t <email server>
smtp-user-enum -M VRFY -U usr/share/wordlists/htb_lists/footprinting-wordlist.txt -t 10.129.143.246 -m 15 -v | tee smtp_users.txt
```

## IMAP/POP3

**IMAP**

| **Command**                     | **Description**                                                                                               |
| ------------------------------- | ------------------------------------------------------------------------------------------------------------- |
| `1 LOGIN username password`     | User's login.                                                                                                 |
| `1 LIST "" *`                   | Lists all directories.                                                                                        |
| `1 CREATE "INBOX"`              | Creates a mailbox with a specified name.                                                                      |
| `1 DELETE "INBOX"`              | Deletes a mailbox.                                                                                            |
| `1 RENAME "ToRead" "Important"` | Renames a mailbox.                                                                                            |
| `1 LSUB "" *`                   | Returns a subset of names from the set of names that the User has declared as being `active` or `subscribed`. |
| `1 SELECT INBOX`                | Selects a mailbox so that messages in the mailbox can be accessed.                                            |
| `1 UNSELECT INBOX`              | Exits the selected mailbox.                                                                                   |
| `1 FETCH <ID> all`              | Retrieves data associated with a message in the mailbox.                                                      |
| `1 CLOSE`                       | Removes all messages with the `Deleted` flag set.                                                             |
| `1 LOGOUT`                      | Closes the connection with the IMAP server.                                                                   |
**POP**

|**Command**|**Description**|
|---|---|
|`USER username`|Identifies the user.|
|`PASS password`|Authentication of the user using its password.|
|`STAT`|Requests the number of saved emails from the server.|
|`LIST`|Requests from the server the number and size of all emails.|
|`RETR id`|Requests the server to deliver the requested email by ID.|
|`DELE id`|Requests the server to delete the requested email by ID.|
|`CAPA`|Requests the server to display the server capabilities.|
|`RSET`|Requests the server to reset the transmitted information.|
|`QUIT`|Closes the connection with the POP3 server.|
#Helpful #SSL_Connect
```bash
nmap 10.129.143.246 -sV -p110,143,993,995 -sC

curl -k 'imaps://10.129.143.246' --user <user>:<pass> -v

openssl s_client -connect 10.129.143.246:pop3s
openssl s_client -connect 10.129.143.246:imaps

```

```bash
a login robin robin
a list "" *
a select dev.department.int
a fetch 1 (BODY[HEADER.FIELDS (SUBJECT)])
a fetch 1 BODY[TEXT]
a fetch 1 ALL
```

