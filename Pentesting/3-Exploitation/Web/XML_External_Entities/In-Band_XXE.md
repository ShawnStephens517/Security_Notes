### XML Entity Expansion

XML Entity Expansion is a technique often used in XXE attacks that involves defining entities within an XML document, which the XML parser then expands. Attackers can abuse this feature by creating recursive or excessively large entities, leading to a Denial of Service (DoS) attack or defining external entities referencing sensitive files or services. This method is central to both in-band and out-of-band XXE, as it allows attackers to inject malicious entities into the XML data. For example:

```xml
<!DOCTYPE foo [<!ELEMENT foo ANY ><!ENTITY xxe "This is a test message" >]><contact><name>&xxe; &xxe;</name><email>test@test.com</email><message>test</message></contact>
```


In the example from THM, we are looking for the contents of a specific file in /opt, we use Entity Expansion to replace the XML from our Burp intercept request with the following

```xml
<!DOCTYPE foo [
<!ELEMENT foo ANY >
<!ENTITY xxe SYSTEM "file:///opt/<.txt>" >]>
```